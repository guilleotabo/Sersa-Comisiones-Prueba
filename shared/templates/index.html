<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Comisiones Comerciales - SERSA SAECA</title>
    
    <!-- Estilos -->
    <link rel="stylesheet" href="../shared/css/main.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="comisiones.css">
</head>
<body>
    <!-- Pantalla de Login -->
    <div id="login-screen" class="login-overlay">
        <div class="login-container">
            <div class="login-header">
                <div class="login-icon">üîê</div>
                <h2>Acceso al Sistema</h2>
                <p>Sistema de Comisiones Comerciales</p>
            </div>
            <div class="login-form">
                <div class="input-group-login">
                    <input type="password" id="password-input" class="login-input" placeholder="Contrase√±a" maxlength="20">
                    <button type="button" class="login-btn">
                        <span class="btn-text">Ingresar</span>
                        <span class="btn-icon">‚Üí</span>
                    </button>
                </div>
                <div id="login-error" class="login-error"></div>
            </div>
            <div class="login-footer">
                <small>Ingresa la contrase√±a para acceder al sistema</small>
            </div>
        </div>
    </div>

    <!-- Aplicaci√≥n Principal -->
    <div class="container" id="main-app">
        <!-- Panel Izquierdo -->
        <div class="left-panel">
            <div class="header">
                <h1>üí∞ Sistema de Comisiones Comerciales</h1>
                <span id="saveIndicator"></span>
                <div class="header-buttons">
                    <button class="header-btn" id="limpiar-btn">üóëÔ∏è Limpiar</button>
                    <button class="header-btn" id="reporte-btn">üìä Reporte</button>
                    <button class="header-btn" id="admin-btn">‚öôÔ∏è Admin</button>
                    <button class="header-btn" id="toggle-sidebar-btn">‚¨ÖÔ∏è Ocultar</button>
                </div>
            </div>
            
            <div class="input-section">
                <!-- Historial -->
                <div class="section-divider">‚ïê‚ïê‚ïê HISTORIAL ‚ïê‚ïê‚ïê</div>
                
                <div class="input-group">
                    <label>Nivel mes anterior</label>
                    <select class="input-field" id="nivelAnterior">
                        <option value="0">Capilla</option>
                        <option value="1">Junior</option>
                        <option value="2" selected>Senior A</option>
                        <option value="3">Senior B</option>
                        <option value="4">M√°ster</option>
                        <option value="5">Genio</option>
                    </select>
                    <div class="help-text">Para c√°lculo de carrera (menor de 2 meses)</div>
                </div>
                
                <!-- Volumen -->
                <div class="section-divider">‚ïê‚ïê‚ïê VOLUMEN ‚ïê‚ïê‚ïê</div>
                
                <div class="input-group">
                    <label>Monto Interno <span class="req">*</span></label>
                    <input type="text" class="input-field required" id="montoInterno" 
                           placeholder="Ej: 950.000.000">
                    <div class="status-text">
                        <span id="internoStatus"></span>
                        <span id="montoLlave" class="llave"></span>
                    </div>
                </div>
                
                <div class="input-group">
                    <label>Monto Externo/Referenciado</label>
                    <input type="text" class="input-field" id="montoExterno"
                           placeholder="Ej: 80.000.000">
                    <div class="status-text">
                        <span id="externoLlave" class="llave"></span>
                    </div>
                </div>
                
                <div class="input-group">
                    <label>Recuperados +3 meses</label>
                    <input type="text" class="input-field" id="montoRecuperado"
                           placeholder="Ej: 60.000.000">
                    <div class="status-text">
                        <span id="recuperadoLlave" class="llave"></span>
                    </div>
                    <div class="help-text">Clientes recuperados despu√©s de 3 meses</div>
                </div>
                
                <div class="input-group">
                    <label>Cantidad Desembolsos <span class="req">*</span></label>
                    <input type="text" class="input-field required" id="cantidadDesembolsos" 
                           placeholder="Ej: 10">
                    <div class="status-text">
                        <span id="cantidadStatus"></span>
                    </div>
                </div>
                
                <!-- Llave Semanal -->
                <div class="section-divider">‚ïê‚ïê‚ïê LLAVE SEMANAL ‚ïê‚ïê‚ïê</div>
                
                <div class="input-group">
                    <label>Desembolsos semanales m√≠nimos <span class="req">*</span> <span class="tooltip" data-tip="Cantidad de desembolsos en tu peor semana">‚ìò</span></label>
                    <input type="text" class="input-field required filled" id="menorSemana" value="2"
                           placeholder="Ej: 2">
                    <div class="llave-info" id="llaveInfo">
                        <div><strong>LLAVE HABILITADA:</strong></div>
                        <div class="llave-rules">
                            <div>‚úÖ 2/sem ‚Üí habilita premio cantidad completo</div>
                            <div>‚ùå Menos de 2/sem ‚Üí sin premio cantidad</div>
                        </div>
                    </div>
                </div>
                
                <!-- Calidad -->
                <div class="section-divider">‚ïê‚ïê‚ïê CALIDAD ‚ïê‚ïê‚ïê</div>
                
                <div class="input-group">
                    <label>Conversi√≥n % <span class="req">*</span></label>
                    <input type="text" class="input-field required" id="conversion"
                           placeholder="Ej: 7" maxlength="5" value="8">
                </div>
                
                <div class="input-group">
                    <label>Empat√≠a/Mystery % <span class="req">*</span></label>
                    <input type="text" class="input-field required" id="empatia"
                           placeholder="Ej: 92" maxlength="3" value="96">
                </div>
                
                <div class="input-group">
                    <label>Proceso/CRM % <span class="req">*</span></label>
                    <input type="text" class="input-field required" id="proceso"
                           placeholder="Ej: 85" maxlength="3" value="95">
                </div>

                <div class="input-group">
                    <label>Mora % <span class="req">*</span></label>
                    <input type="text" class="input-field required" id="mora"
                           placeholder="Ej: 2" maxlength="3" value="2">
                </div>
                
                <!-- Otros -->
                <div class="section-divider">‚ïê‚ïê‚ïê OTROS ‚ïê‚ïê‚ïê</div>
                
                <div class="input-group">
                    <label>Menor nivel del equipo</label>
                    <select class="input-field" id="nivelEquipo">
                        <option value="0">Capilla</option>
                        <option value="1">Junior</option>
                        <option value="2" selected>Senior A</option>
                        <option value="3">Senior B</option>
                        <option value="4">M√°ster</option>
                        <option value="5">Genio</option>
                    </select>
                    <div class="help-text">Para premio equipo (desde Senior A)</div>
                </div>
            </div>
        </div>

        <!-- Bot√≥n para abrir sidebar -->
        <button id="open-sidebar-btn" class="open-sidebar-btn">‚û°Ô∏è Mostrar</button>

        <!-- Panel Derecho -->
        <div class="right-panel">
            <div class="top-stats">
                <div class="stat">
                    <span class="stat-label">Asesor:</span>
                    <span class="stat-value" id="statAsesor">Base</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Tu Nivel:</span>
                    <span class="stat-value" id="statNivel">Senior A</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Subtotal:</span>
                    <span class="stat-value" id="statSubtotal">0 Gs</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Multiplicador:</span>
                    <span class="stat-value" id="statMulti">0%</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Comisi√≥n:</span>
                    <span class="stat-value" style="color: #2E7D32;" id="statComision">0 Gs</span>
                </div>
            </div>
            
            <div class="results-container">
                <!-- Fila 1: Monto Interno y Externo -->
                <div class="card">
                    <div class="card-title">üìä MONTO INTERNO - Meta desembolso | Premio comisi√≥n</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="barraInterno"></div>
                    </div>
                    <div class="progress-info" id="infoInterno"></div>
                </div>
                
                <div class="card">
                    <div class="card-title">üíé MONTO EXTERNO/REFERENCIADO - Meta | Premio</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="barraExterno"></div>
                    </div>
                    <div class="progress-info" id="infoExterno"></div>
                </div>
                
                <!-- Fila 2: Cantidad y Recuperados -->
                <div class="card">
                    <div class="card-title">üéØ CANTIDAD DESEMBOLSOS - Meta | Premio | Llave</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="barraCantidad"></div>
                    </div>
                    <div class="progress-info" id="infoCantidad"></div>
                </div>
                
                <div class="card">
                    <div class="card-title">üîÑ RECUPERADOS +3 MESES - Meta | Premio</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="barraRecuperado"></div>
                    </div>
                    <div class="progress-info" id="infoRecuperado"></div>
                </div>
                
                <!-- Fila 3: Carrera y Equipo -->
                <div class="card">
                    <div class="card-title">üìà PREMIO CARRERA - Seg√∫n menor nivel √∫ltimos 2 meses</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="barraCarrera"></div>
                    </div>
                    <div class="progress-info" id="infoCarrera"></div>
                </div>
                
                <div class="card">
                    <div class="card-title">üë• PREMIO EQUIPO - Seg√∫n menor nivel del equipo</div>
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="barraEquipo"></div>
                    </div>
                    <div class="progress-info" id="infoEquipo"></div>
                    <div id="equipoRequisitos" style="margin-top: 8px; padding: 8px; background: #FFF3E0; border-radius: 4px; font-size: 11px; color: #E65100;">
                        ‚ö†Ô∏è Necesitas estar en Senior A+ para cobrar premio equipo
                    </div>
                </div>
                
                <!-- Barra de Subtotal -->
                <div class="card full-width">
                    <div class="card-title">üí∞ SUBTOTAL ACUMULADO (sin multiplicadores)</div>
                    <div class="subtotal-bar">
                        <div class="subtotal-fill" id="subtotalFill"></div>
                    </div>
                    <div class="subtotal-text">
                        Subtotal: <strong id="subtotalMonto">0 Gs</strong> de <strong>14.000.000 Gs</strong>
                    </div>
                </div>
                
                <!-- Multiplicadores -->
                <div class="card full-width">
                    <div class="card-title">‚≠ê MULTIPLICADORES (SE APLICAN EN CADENA)</div>
                    <div class="multiplier-tables" id="multiplicadorTables"></div>
                    <div class="multiplier-calc" id="multiplicadorCalc">
                        C√°lculo: - √ó - √ó - = 0%
                    </div>
                </div>
                
                <!-- C√°lculo de Comisi√≥n y Sugerencias -->
                <div class="card full-width">
                    <div class="card-title">üí∞ C√ÅLCULO DE COMISI√ìN Y SUGERENCIAS</div>
                    <div class="commission-calculation">
                        <div class="calc-section">
                            <div class="calc-row">
                                <span>Base fija:</span>
                                <span id="calcBase">0 Gs</span>
                            </div>
                            <div class="calc-row">
                                <span>Carrera:</span>
                                <span id="calcCarrera">0 Gs</span>
                            </div>
                            <div class="calc-row">
                                <span>Monto Interno:</span>
                                <span id="calcInterno">0 Gs</span>
                            </div>
                            <div class="calc-row">
                                <span>Monto Ext/Ref:</span>
                                <span id="calcExterno">0 Gs</span>
                            </div>
                            <div class="calc-row">
                                <span>Recuperados:</span>
                                <span id="calcRecuperado">0 Gs</span>
                            </div>
                            <div class="calc-row">
                                <span>Cantidad <span id="cantidadLlaveInfo"></span>:</span>
                                <span id="calcCantidad">0 Gs</span>
                            </div>
                            <div class="calc-row">
                                <span>Equipo:</span>
                                <span id="calcEquipo">0 Gs</span>
                            </div>
                            <div class="calc-divider"></div>
                            
                            <div class="calc-row">
                                <span>Subtotal:</span>
                                <span id="calcSubtotal">0 Gs</span>
                            </div>
                            <div class="calc-row">
                                <span>√ó Multi:</span>
                                <span id="calcMultiplicador">0%</span>
                            </div>
                            
                            <div class="calc-total">
                                <div class="calc-total-label">TOTAL COMISI√ìN</div>
                                <div class="calc-total-value" id="totalComision">0 Gs</div>
                            </div>
                        </div>
                        
                        <div class="suggestions-section">
                            <div class="card-title" style="margin-top: 0;">üí° SUGERENCIAS PERSONALIZADAS</div>
                            <div id="sugerencias"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Informaci√≥n de carrera -->
                <div class="card full-width">
                    <div class="info-section">
                        <h4>üìñ C√ìMO SE DEFINE TU CARRERA</h4>
                        Tu nivel de carrera se determina por el <strong>MENOR</strong> nivel alcanzado entre:
                        <br>‚Ä¢ Monto Interno + Monto Externo + Recuperados + Cantidad Desembolsos
                        <br>‚Ä¢ Se considera el menor de los √∫ltimos 2 meses para estabilidad
                        <br>‚Ä¢ NO se consideran: Premio Equipo ni penalizaciones
                    </div>
                    
                    <div class="info-section quick-guide">
                        <h4>üìö GU√çA R√ÅPIDA</h4>
                        ‚Ä¢ <strong>Llaves:</strong> Sin 6 desemb. no hay premio interno | 2/sem habilita premio cantidad
                        <br>‚Ä¢ <strong>Multiplicadores:</strong> Se aplican en cadena (Conv √ó Emp √ó Proc)
                        <br>‚Ä¢ <strong>Base fija:</strong> Siempre 3M, nunca se multiplica
                        <br>‚Ä¢ <strong>Equipo:</strong> Premio seg√∫n menor nivel del equipo (desde Senior A)
                        <br>‚Ä¢ <strong>Meta vs Premio:</strong> Meta = monto a desembolsar | Premio = comisi√≥n que gan√°s
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <!-- Configuraci√≥n (debe cargarse primero) -->
    <script src="config.js"></script>
    
    <!-- M√≥dulos del sistema (en orden de dependencias) -->
    <script src="../shared/js/utils.js"></script>
    <script src="../shared/js/api.js"></script>
    <script src="../shared/js/calculations.js"></script>
    <script src="../shared/js/ui.js"></script>
    
    <!-- Aplicaci√≥n principal (debe cargarse al final) -->
    <script src="../shared/js/app-main.js"></script>
    
    <!-- Scripts espec√≠ficos del asesor (si existen) -->
    <script src="reports.js"></script>
</body>
</html>